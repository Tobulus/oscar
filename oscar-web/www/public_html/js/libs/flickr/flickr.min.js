define(["jqueryui","slimbox"],function(){return flickr={_api_key:"46f7a6dce46471b81aa7c1592fcc9733",_query:function(b,d,c){var e=[],a;a="https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key="+this._api_key;a=a+("&text="+b)+"&format=json";a+="&nojsoncallback=1";a+="&sort=relevance";a+="&lat="+d.lat;a+="&lon="+d.lng;$.getJSON(a,function(a){var b,d;for(d in a.photos.photo)b=a.photos.photo[d],e.push({url:"https://farm"+b.farm+".staticflickr.com/"+b.server+"/"+b.id+"_"+b.secret+"_t.jpg",
title:b.title,photo_id:b.id});c(e)})},getImagesForLocation:function(b,d){this._query(b,d,this._showImagesForLocation.bind(this))},_setPhotoUrl:function(b,d){var c;c="https://api.flickr.com/services/rest/?method=flickr.photos.getSizes&format=json&nojsoncallback=1";c+="&api_key="+this._api_key;c+="&photo_id="+b;$.getJSON(c,function(b){for(var a=b.sizes.size.length-1;1024<b.sizes.size[a].width;)a--;$(d).attr("href",b.sizes.size[a].source)})},_showImagesForLocation:function(b){for(var d=$("#flickr_images").empty(),
c=0;50>c&&c<b.length;c++){var e=b[c],a=$("<a />").attr("rel","lightbox-group").attr("title",e.title||"");$("<img/>").attr("src",e.url).appendTo(a);this._setPhotoUrl(b[c].photo_id,a);a.appendTo(d)}0<b.length?($("#flickr").show("slide",{direction:"right"},myConfig.styles.slide.speed),$("a[rel^='lightbox']").slimbox({},null,function(a){return this==a||8<this.rel.length&&this.rel==a.rel})):$("#flickr").hide("slide",{direction:"right"},myConfig.styles.slide.speed)}}});
